---
layout: article
---

The simplest control-flow instruction is `if`. By the name, I think it's so obvious there is nothing to explain how it works.

The syntax is as follows:

```c++
if (condition)
    statement;
```

The `condition` can be any expression that is or can be converted to value of type `bool`. The statement below is executed if it's `true`.

```c++
#include <iostream>

int main()
{
    std::cout << "enter a number: ";
    int x;
    std::cin >> x;

    if (x % 2 == 0)
        std::cout << x << "is even\n";
    //^ the statement is indented
}
```

Note that it doesn't matter if the statement is actually indented - but it's a good thing to do so - it creates logical scope and clearly expresses that the code is dependent.

The program above will test the parity of the number. There is one thing missing though - it doesn't print anything if `x` is odd.

## else

The negative branch of `if` can be added by the `else` keyword

```c++
if (condition)
    statement;
else
    statement;
```

```c++
#include <iostream>

int main()
{
    std::cout << "enter a number: ";
    int x;
    std::cin >> x;

    if (x % 2 == 0)
        std::cout << x << " is even\n";
    else
        std::cout << x << " is odd\n";
}
```

If you want only the negative branch, just flip the condition: `if (!condition)`. or reverse the operator (eg `!=` instead of `==`, `<` instead of `>=`).

## grouping

Multiple statements can be grouped together by braces:

```c++
#include <iostream>

int main()
{
    std::cout << "enter a number: ";
    int x;
    std::cin >> x;

    if (x % 2 == 0)
    {
        std::cout << x << " is even\n";
        // more statements can follow here...
    }
    else
    {
        std::cout << x << " is odd\n";
        // more statements can follow here...
    }
}
```

## nesting

Statements can be nested:

```c++
#include <iostream>

int main()
{
    std::cout << "enter a number: ";
    int x;
    std::cin >> x;

    if (x % 2 == 0)
    {
        std::cout << x << " is even\n";

        if (x % 4 == 0)
            std::cout << x << " is divisible by 4\n";
    }
    else
    {
        std::cout << x << " is odd\n";
    }
}
```

For more statements, it's recommended to use braces. Some coding styles even request to *always* put braces - this is controversial as in some cases they create more unnecessary noise and there exists languages such as Python which don't even have braces - they use indentiation level instead.

If you skip braces in the program above, a bad thing will happen.

```c++
#include <iostream>

int main()
{
    std::cout << "enter a number: ";
    int x;
    std::cin >> x;

    if (x % 2 == 0)
        std::cout << x << " is even\n";

        if (x % 4 == 0)
            std::cout << x << " is divisible by 4\n";
    else
        std::cout << x << " is odd\n";
}
```

Try it with number `6`. The program will print that 6 is even but also that 6 is odd. It's because the `else` ties to the last `if`, not to the `if` on the same indentation.

A good compiler should emit a warning:

```c++
main.cpp: In function 'int main()':
main.cpp:9:5: warning: this 'if' clause does not guard... [-Wmisleading-indentation]
     if (x % 2 == 0)
     ^~
main.cpp:12:9: note: ...this statement, but the latter is misleadingly indented as if it were guarded by the 'if'
         if (x % 4 == 0)
         ^~
```

The code is interpreted as this:

```c++
    if (x % 2 == 0)
        std::cout << x << " is even\n";

    if (x % 4 == 0)
        std::cout << x << " is divisible by 4\n";
    else
        std::cout << x << " is odd\n";
```

Which is obviously wrong.

TODO remainder block

In C++ (and many other languages, especially ones deriving syntax from C) whitespace (blank characters such as space, tabs and new lines) does not affect scoping.

<div class="note success">
<h4>Braces and scoping</h4>

Always put braces around outer statements if you nest control blocks. Skipping braces should be allowed *at most* at the most-inner block.
</div>

Example:

```c++
if (condition)
{
    if (other_condition)
    {
        something;
    }
    else
    {
        if (some_other_condition) // only here braces can be ommited
            something_diferent;
    }
}
else
{
    if (very_different_condition) // only here braces can be ommited
        something_very_different;
}
```

## chaining

One trick to leverage rule that `else` ties to the last `if` is to form a chain of else-if blocks.

```c++
#include <iostream>

int main()
{
    std::cout << "enter a number: ";
    int x;
    std::cin >> x;

    if (x % 2 == 0)
        std::cout << x << " is even\n";
    else if (x % 4 == 0)
        std::cout << x << " is divisible by 4\n";
    else if (x % 8 == 0)
        std::cout << x << " is divisible by 8\n";
    else if (x % 16 == 0)
        std::cout << x << " is divisible by 16\n";
    else if (x % 32 == 0)
        std::cout << x << " is divisible by 32\n";
    else
        std::cout << x << " is odd\n";
}
```

Try the program above with numbers 3, 8, 12, 48 and 1024.

The code in braced version would look differently:

```c++
#include <iostream>

int main()
{
    std::cout << "enter a number: ";
    int x;
    std::cin >> x;

    if (x % 2 == 0)
    {
        std::cout << x << " is even\n";
    }
    else
    {
        if (x % 4 == 0)
        {
            std::cout << x << " is divisible by 4\n";
        }
        else
        {
            if (x % 8 == 0)
            {
                std::cout << x << " is divisible by 8\n";
            }
            else
            {   
                if (x % 16 == 0)
                {
                    std::cout << x << " is divisible by 16\n";
                }
                else
                {
                    if (x % 32 == 0)
                    {
                        std::cout << x << " is divisible by 32\n";
                    }
                    else
                    {
                        std::cout << x << " is odd\n";
                    }
                }
            }
        }
    }
}
```

The entire tree of branches moves only in one direction - in such cases using else-if trick helps to create shorter code which is easier to read.

<div class="note pro-tip">
<h4>Code readability</h4>
Avoid code Hadoukens.

![code Hadouken](http://i.imgur.com/BtjZedW.jpg)

If you happen to have more than 4 nested blocks you likely are doing something wrong - usually too complex logic or lack of code modularity.
</div>

## common mistakes

There are few common things to watch out for.

**assignment in condition**

```c++
if (x = 0) // = instead of ==
    std::cout << "x is zero\n";
```

The code above assigns `0` to `x` instead of comparing it.

It compiles because after the assignment the expression evaluates to `x` converting it's value to type `bool` which in this case will always be zero.

You may occasionally make this mistake, the good part is that every major compiler (and others probably too) emit a warning for such code.

Some coding styles recommend to swap the order, in such case `0 == x` has no difference but `0 = x` would not compile. This impacts readability though.

TODO Trivia block

In some programming languages, there is a rule that probihits assignments in conditions. In C++ there is no such rule due to backwards compability. A lot of C code use this trick intentionally in lines such as `if ((x = func()) != 0)`. This is not a very good style though.

**accidental semicolon**

```c++
if (x == 0); // null statement after if
    std::cout << "Can't divide by zero!\n"; // this is not a part of the if
```

Compilers also ouput warning about such code.

**end of scope**

TODO find better example

```c++
#include <iostream>

int main()
{
    std::cout << "enter a number: ";
    int x;
    std::cin >> x;

    if (x % 2 == 0)
    {
        int y = x / 2;
    } // y dies here
    else
    {
        int y = x;
    } // a different y dies here

    std::cout << "after possible division, x is " << y << "\n"; // error: there is no y
}
```

The program above does not compile. There are 2 different `y`s where each has a separte lifetime. There is no `y` in the outer scope.

This problem occurs also if you ommit braces.

Solution: define `y` before if-else block.

**inconsistent braces**

As with many style decisions, every choice is good as long as you stick to it.

```c++
    if (x % 2 == 0)
    {
        std::cout << x << " is even\n";
    }
    else
        std::cout << x << " is odd\n";
```

The code above breaks this rule. Either brace both statements or none.

<div class="note pro-tip">

Often there is more than one way to write the same code. Pick the style you prefer and **be consistent**.
</div>

## ?: operator

There is another way to write `if`s - using the ternary `?:` operator.

```c++
// condition ? positive_statement : negative_statement
std::cout << "x is " << (x % 2 == 0) ? "even" : "odd" << "\n";
```

The problem is that the operator does not require full statements. It can be easily abused - especially when nested. Additionally, the operator itself has [complex rules](https://en.cppreference.com/w/cpp/language/operator_other#Conditional_operator) regarding evaluation.

It's recommended not to use this operator unless very justified. It creates shorter code but it's much harder to read and has much more places for potential bugs.

## if with initialization statement

Since C++17 it's possible to embed additional instruction before the condition.

```c++
int x = 5;
if (int y = x * 2; (x + y) % 2 == 0)
//  ^instruction^; ^^condition^^ 
{
    // code...
}
else
{
    // y still available here
}
// y no longer exists here
```

It has use in scenarios when you need a variable but only for the if-else blocks.

## exercise

- Make a simple console calculator. Ask for integers x, y and operation (1 can mean addition, 2 subtraction, ...). Do not allow to divide by 0 - print an error instead.
- Test whether your compiler emits a warning about assignment in condition and null stetment after if. Try to intentionally create some errors - later it will help you to find what's wrong in case of accidental mistakes.

TODO test code and formatting

<details>
<summary> Calculator solution </summary>
<p markdown="block">

~~~ c++
#include <iostream>

int main()
{
    std::cout << "Console calculator\n";
    std::cout << "Select an operation:\n"
        "1. addition\n"
        "2. subtraction\n"
        "3. multiplication\n"
        "4. division\n"
        "5. modulus\n";
        
    int choice = 0;
    std::cin >> choice;
    
    if (choice <= 0 || choice > 5)
    {
        std::cout << "Wrong choice.\n";
        return 1;    
    }
    
    int x;
    int y;
    std::cout << "Enter x: ";
    std::cin >> x;
    std::cout << "Enter y: ";
    std::cin >> y;
    
    if (choice == 1)
    {
        std::cout << "x + y = " << x + y << "\n";
    }
    else if (choice == 2)
    {
        std::cout << "x - y = " << x - y << "\n";
    }
    else if (choice == 3)
    {
        std::cout << "x * y = " << x * y << "\n";
    }
    else if (choice == 4)
    {
        if (y == 0)
        {
            std::cout << "Can not divide by zero!\n";
            return 1;
        }
        else
        {
            std::cout << "x / y = " << x / y << "\n";
        }
        
    }
    else if (choice == 5)
    {
        std::cout << "x % y = " << x % y << "\n";
    }
}
~~~

</p>
</details>
